% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clim_corr_m.R
\name{clim_corr_m}
\alias{clim_corr_m}
\title{Calculate Monthly Climate Correlation with Moving Window (Handles Frequency)}
\usage{
clim_corr_m(
  growth_data,
  climate_data,
  growth_var = "res",
  climate_var_name = "climate",
  window_width = 12,
  start_year = NULL,
  end_year = NULL,
  cor_method = "pearson",
  daily_agg_fun = "auto",
  value_col = "value"
)
}
\arguments{
\item{growth_data}{A data frame with tree growth data ('year', \code{growth_var}).}

\item{climate_data}{A data frame with climate data, typically the output of
\code{read_climate_data}. Can be daily (must contain 'date'/'value' or
'year'/'month'/'day'/'value') or monthly ('year', '1'..'12'). The function
checks the "frequency" attribute or column names to determine the type.}

\item{growth_var}{Character string. Growth index column name (default: "res").}

\item{climate_var_name}{Character string. Base name for climate variable (default: "climate").}

\item{window_width}{Integer. Moving window width in months (default: 12).}

\item{start_year}{Optional integer. First year for analysis.}

\item{end_year}{Optional integer. Last year for analysis.}

\item{cor_method}{Character string. Correlation method (default: "pearson").}

\item{daily_agg_fun}{Function or Character string. The function used to aggregate daily
data to monthly. Default is "sum" (appropriate for precipitation). Can be "mean"
(for temperature) or a custom function. Function checks \code{variable_type} attribute
from \code{climate_data} to guess if not specified ("sum" for "P", "mean" for "T").}

\item{value_col}{Character string. Name of the value column in \code{climate_data} if
it's daily (used internally if daily). Default is "value".}
}
\value{
A tidy data frame summarizing the monthly correlation results (columns:
end_month, month_abbr, correlation, p_value, n_overlap, climate_var),
or NULL if calculations fail.
}
\description{
Calculates the correlation between a tree-growth variable and a climate
variable aggregated over a moving window (monthly analysis). Handles both daily
and monthly input climate data (output from \code{read_climate_data}). Daily data is
automatically aggregated to monthly sums before calculating the rolling window.
}
\examples{
# --- Generate Sample Data ---
growth <- data.frame(year = 1950:2000, res = rnorm(51))
# Monthly Climate Data
climate_m <- data.frame(year = 1949:2001); for(m in 1:12) climate_m[[as.character(m)]]<-runif(53,10,60)
attr(climate_m, "frequency") <- "monthly"; attr(climate_m, "variable_type") <- "P"
# Daily Climate Data (Temp)
dates_d <- seq(as.Date("1949-01-01"), as.Date("2001-12-31"), by = "day")
climate_d_t <- data.frame(date = dates_d, value = rnorm(length(dates_d), 15, 5))
attr(climate_d_t, "frequency") <- "daily"; attr(climate_d_t, "variable_type") <- "T"

# --- Run clim_corr_m with MONTHLY input ---
results_m <- clim_corr_m(growth, climate_m, climate_var_name = "prec_m")
print("Results from Monthly Input:")
print(results_m)

# --- Run clim_corr_m with DAILY TEMP input (should use mean) ---
results_d_t <- clim_corr_m(growth, climate_d_t, climate_var_name = "temp_d")
print("Results from Daily Temp Input (aggregated with mean):")
print(results_d_t)

# --- Run clim_corr_m forcing SUM aggregation on Temp data ---
# results_d_t_sum <- clim_corr_m(growth, climate_d_t, daily_agg_fun = "sum")
# print(results_d_t_sum) # Compare correlations

}
