% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_corr_db.R
\name{plot_corr_db}
\alias{plot_corr_db}
\title{Plot Comparative Climate Correlation Heatmap}
\usage{
plot_corr_db(
  combined_correlation_data,
  dataset_display_names = NULL,
  significance_level = 0.05,
  order_by_month = "Jun",
  mark_non_significant = "*",
  plot_title = "Climate Correlation Comparison",
  plot_subtitle = NULL,
  axis_label_x = "End Month of Window",
  axis_label_y = "Dataset",
  legend_title = "  r",
  color_palette_diverging = NULL,
  color_palette_sequential = NULL,
  base_font_size = 11
)
}
\arguments{
\item{combined_correlation_data}{A data frame containing combined correlation
results. Must include columns: 'month_abbr' (or 'end_month'), 'correlation',
'p_value', and 'dataset' (character identifier for each dataset).}

\item{dataset_display_names}{Optional named character vector or list to map
dataset identifiers (from the 'dataset' column) to nicer names for the
plot axis. E.g., \code{c(era5 = "ERA5", cru = "CRU TS 4.0")}. If NULL, original
dataset identifiers are used.}

\item{significance_level}{Numeric. The threshold for statistical significance
(default: 0.05). P-values >= this level will be marked.}

\item{order_by_month}{Character. The month abbreviation (e.g., "Jun", "Jul")
used to order the datasets vertically on the heatmap based on descending
correlation in that month. If NULL, datasets are ordered alphabetically.
Default: "Jun".}

\item{mark_non_significant}{Character. The symbol to append to correlation values
where p >= significance_level (default: "*"). Set to "" to disable marking.}

\item{plot_title}{Character string. The main title for the plot.}

\item{plot_subtitle}{Character string or NULL. Subtitle for the plot. Can be
automatically generated if NULL to show period and significance.}

\item{axis_label_x}{Character string. Label for the X-axis (months).}

\item{axis_label_y}{Character string. Label for the Y-axis (datasets).}

\item{legend_title}{Character string. Title for the color scale legend.}

\item{color_palette_diverging}{Character vector. Color palette from
\code{RColorBrewer::brewer.pal} for diverging scales (used if negative
correlations are present). Default: \code{rev(RColorBrewer::brewer.pal(11, "RdBu"))}.}

\item{color_palette_sequential}{Character vector. Color palette for sequential
scales (used if correlations are mostly non-negative). Starts with "white".
Default: \code{c("white", RColorBrewer::brewer.pal(9, "YlOrRd"))}.}

\item{base_font_size}{Numeric. Base font size for the plot theme (default: 11).}
}
\value{
A \code{ggplot} object representing the heatmap. The user can then print,
save (using \code{ggplot2::ggsave}), or modify it.
}
\description{
Generates a heatmap comparing climate correlation results (e.g., growth vs.
aggregated climate variable) across multiple climate datasets. Assumes input
data is the combined output from running \code{clim_corr} for several datasets.
}
\examples{
# --- Create dummy combined correlation data for example ---
datasets <- c("Dataset_A", "Dataset_B", "Dataset_C")
months <- month.abb
dummy_data_list <- list()
for (d in datasets) {
  set.seed(which(datasets == d)) # for reproducibility
  dummy_data_list[[d]] <- data.frame(
     month_abbr = factor(months, levels = month.abb),
     correlation = runif(12, -0.3, 0.6),
     p_value = runif(12, 0, 0.2),
     dataset = d,
     n_overlap = sample(30:50, 12, replace = TRUE) # Example n
  )
}
combined_dummy_data <- dplyr::bind_rows(dummy_data_list)

# --- Basic Plot ---
p1 <- plot_corr_db(combined_dummy_data)
# print(p1) # Suppressing print in examples

# --- Plot with Options ---
display_names <- c(Dataset_A = "Alpha Data", Dataset_B = "Beta Climate",
                   Dataset_C = "Gamma Source")
p2 <- plot_corr_db(
  combined_dummy_data,
  dataset_display_names = display_names,
  order_by_month = "Jul",
  significance_level = 0.10,
  plot_title = "Example Comparative Heatmap",
  axis_label_x = "Final Month of Window"
)
# print(p2)

}
